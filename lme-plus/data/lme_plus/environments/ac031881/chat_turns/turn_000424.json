{
  "turn_global_index": 424,
  "session_index": 38,
  "session_id": "sharegpt_nE62dqp_79",
  "turn_in_session": 6,
  "date": "2023/05/29 (Mon) 11:30",
  "role": "assistant",
  "content": "Sure! Here's an updated query that includes both the organization name and the course module id in the grouping:\n```sql\nSELECT \n  organizations.name AS organization_name,\n  course_module_sessions.course_module_id,\n  (COUNT(CASE WHEN reflect_items.immediate_reactions IS NULL\n      AND reflect_items.updated_at > reflect_items.created_at\n      AND course_module_sessions.completed_at is NOT NULL\n      THEN 1 END) / \n   COUNT(CASE WHEN reflect_items.updated_at > reflect_items.created_at\n               AND course_module_sessions.completed_at is NOT NULL THEN 1 END)) * 100 \n  AS `Percentage of Null & Updated Rows`\nFROM praxislabs.organizations \nLEFT JOIN praxislabs.users \nON users.organization_id = organizations.id\nLEFT JOIN praxislabs.cohorts \nON cohorts.id = users.cohort_id\nLEFT JOIN praxislabs.course_module_sessions \nON course_module_sessions.user_id = users.id\nLEFT JOIN praxislabs.reflect_items \nON reflect_items.course_module_session_id = course_module_sessions.id\nGROUP BY organizations.name, course_module_sessions.course_module_id\nORDER BY organizations.name, course_module_sessions.completed_at\n```",
  "has_answer": false
}