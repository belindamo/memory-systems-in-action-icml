{
  "session_id": "sharegpt_2xK3jjf_0",
  "session_index": 24,
  "date": "2023/05/25 (Thu) 15:18",
  "turns": [
    {
      "role": "user",
      "content": "modify the flutter code for task details as below needs \n\nthe page view will be as sections\n 1st section \nRow1: in the left \"task\\_name\" in the right \"task\\_id\"\nRow2: in the left \"related\\_to\" n the right \"task\\_status\": \n2nd section \nrow1: \"customer\\_group\" on the left and \"task\\_status\" on right \nrow2: Creited: \"task\\_created\\_date\" in the left side and only date format no time \nDue: \"due\\_date\" in the right side only date format no time \nRow3: Assigned by \"created\\_by\" in the right Assigned to: \"permission\"\n2nd section \nRow1: title view \"Task Details\" bold and big size \nRow 2: \"task\\_description\" as a non-editable box. height varies with the length of the text and it fills the width of the page\n Row 3: The task for: \"task\\_for\\_name\"\n Row 4: Contact 1: \"task\\_for\\_contacts1\" / should have a call icon and this will have an action to direct to make a call using mobile & have a WhatsApp icon and this will direct to make chat over WhatsApp \nRow 5: Contact 2: \"task\\_for\\_contacts2\" / should have a call icon and this will have an action to direct to make a call using mobile & have a WhatsApp icon and this will direct to make chat over WhatsApp \nRow 6: Task location Using Google map API Lat, Long (\"task\\_lat, \"task\\_long\") values linkable in map icon \nRow 6: \"tasks\\_notes\" as an editable box. height 2 lines with the length of the text and it fills the width of the page\nRow 7: bottom to change status on the right and bottom to update notes on the left side \nfor the update note will be Gary and it the changed to blue once the user modifies the note in Row 7\nfor \nTo change the status the workflow will as below the bottom text and the action be applied below \n\nIf the tasks' status is \u201cnot\\_started\u201d then will show only one action to In bottom to make the task \u201cin\\_progress\u201d\n\nIf the status is \u201cin\\_progress\u201d then only one action can be applied to Make it \u201cDone\u201d and the status will be \u201cwaiting\\_for\\_someone\u201d, only admin type users have the option to send it back to \u201cnot\\_started\u201d\nIf the status is \u201cwaiting\\_for\\_someone\u201d then only admin-type users can make it Completed action will be applied to API Make to make \u201cCompleted\u201d and the status will be \u201ccompleted\u201d\nonly admin-type users have the option to send it back to \u201cin\\_progress\u201d\n\n\n3rd section (show this section in the case of \"merchant\\_id\" is not null)\nRow1: title view \"Merchant Info\" bold and big size \nmerchant\\_Name: [restaurant\\_name]\nmerchant\\_phone: [restaurant\\_phone] / should have a call icon and this will have an action to direct to make a call using mobile & have a WhatsApp icon and this will direct to make chat over WhatsApp \nmerchant\\_contact: [contact\\_name]\nmerchant\\_contact\\_phone: [contact\\_phone] / should have a call icon and this will have an action to direct to make a call using mobile & have a WhatsApp icon and this will direct to make chat over WhatsApp \nmerchant\\_status [status]\nmerchant\\_admin\\_note: [admin\\_note]\n\n4th section (show this section in the case of \"invoice\\_id\" is not null)\nRow1: title view \"Invoice Info\" bold and big size \nRow2: Invoice ID: \"invoice\\_id\" on the right and \"invoice\\_date\" on the left side Row3: Amount: \"amount\"\nRow4: \"invoice\\_URL\" this will be linkable as a hyperlink bottom to open in the browse \n5th section (show this section in the case of \"driver\\_id\" is not null)\nRow1: title view \"Driver info\" bold and big size \nRow2:driver\\_Name: [first\\_name] & \" \" & [last\\_name] in right & driver\\_status\" [status] in the left side \nRow 3: driver\\_phone: [phone] / should have a call icon and this will have an action to direct to make a call using mobile & have a WhatsApp icon and this will direct to make chat over WhatsApp \nRow 5: driver\\_admin\\_note: [admin\\_note] \n\n6th section (show this section in the case of \"client\\_id\" is not null)\nRow1: title view \"Client info\" bold and big size \nRow2:client\\_Name: [first\\_name] &\" \" & [last\\_name] / if null don't show it.\nRow3:client\\_phone: [contact\\_phone] / / should have a call icon and this will have an action to direct to make a call using mobile & have a WhatsApp icon and this will direct to make chat over WhatsApp / if null don't show it.\n7th section\nRow1: title view \"Activities \" bold and big size and here will have a dropdown view of the Activities list need to press to see the Activities \n\nlast section\nRow1: title view \"Activities \" bold and big size\nrow 2: dynamic list of comments as come from API\n\"user\\_id\" {user Name} on the left and \"comment\\_datetime\" in the right\nnext line \"tbl\\_task\\_comment\" \nseparate each comment row with a shadow line\nend of the page to be a secure chat box write inside in lite gay \"Add comments\"\n\nconsider the below \n-colour the status text of the task and box to change the status as \n-\"in\\_progress\" to be \"in\\_progress\" and box in orange colour\n-Waiting for approval tasks to be Waiting for approval and box in Blue color with black border\n\"completed\" Tasks to be n Green color\nWrite comments on the code for each code to explain it\nUse of null checks in a proper way\nenhance Error handling\nenhance the code performance\nenhance the UI and make it better as we are making todo style \nmake the code faster \nmake lite grey background color \nseparate each section in the view as a different square \n\nimport 'package:efendim\\_admin/src/Tasks%20Managment/models/task.dart';\nimport 'package:efendim\\_admin/src/Tasks%20Managment/models/taskByCateg.dart';\nimport 'package:efendim\\_admin/src/Tasks%20Managment/services/api\\_service.dart';\nimport 'package:efendim\\_admin/src/Tasks%20Managment/widgets/custom\\_app\\_bar.dart';\nimport 'package:efendim\\_admin/src/Tasks%20Managment/widgets/task\\_comments.dart';\nimport 'package:flutter/material.dart';\n\nimport '../models/activity.dart';\nimport '../models/comment.dart';\nimport '../widgets/task\\_activities.dart';\n\nclass TaskDetailsScreen extends StatefulWidget {\n final TasksList task;\n\n const TaskDetailsScreen({Key? key, required this.task}) : super(key: key);\n\n @override\n \\_TaskDetailsScreenState createState() => \\_TaskDetailsScreenState();\n}\n\nclass \\_TaskDetailsScreenState extends State {\n late TasksList \\_task;\n late List \\_comments;\n late bool \\_isLoading;\n\n @override\n void initState() {\n super.initState();\n \\_task = widget.task;\n \\_comments = [];\n \\_isLoading = false;\n \\_fetchComments();\n }\n\n @override\n Widget build(BuildContext context) {\n return Scaffold(\n appBar: CustomAppBar(\n title: \\_task.taskName,\n actions: [],\n ),\n body: SingleChildScrollView(\n child: Padding(\n padding: EdgeInsets.all(16.0),\n child: Column(\n crossAxisAlignment: CrossAxisAlignment.start,\n children: [\n Text(\n \\_task.taskDescription,\n style: TextStyle(fontSize: 18.0, fontWeight: FontWeight.bold),\n ),\n SizedBox(height: 16.0),\n Row(\n children: [\n Text(\n 'Status: ${\\_task.taskStatus}',\n style: TextStyle(fontSize: 16.0),\n ),\n SizedBox(width: 16.0),\n Text(\n 'Created By: ${\\_task.createdBy}',\n style: TextStyle(fontSize: 16.0),\n ),\n ],\n ),\n SizedBox(height: 16.0),\n Row(\n children: [\n Icon(Icons.calendar\\_today),\n SizedBox(width: 8.0),\n Text(\n 'Created On: ${\\_task.taskCreatedDate}',\n style: TextStyle(fontSize: 16.0),\n ),\n ],\n ),\n SizedBox(height: 16.0),\n \\_buildDetailsTable(),\n SizedBox(height: 16.0),\n \\_buildStatusButtons(),\n SizedBox(height: 16.0),\n TaskComments(\n comments: \\_comments,\n onCommentAdded: (String comment) {\n \\_addComment(comment);\n },\n ),\n SizedBox(height: 16.0),\n TaskActivities(activities: [\n Activity(\n activityDate: DateTime.now(),\n value1: \"test activ\",\n activity: \"Test activity\",\n value2: \"test value 2\")\n ]),\n ],\n ),\n ),\n ),\n );\n }\n\n Widget \\_buildDetailsTable() {\n return Table(\n columnWidths: {\n 0: FlexColumnWidth(2),\n 1: FlexColumnWidth(3),\n },\n children: [\n \\_buildDetailsTableRow('Task ID', \\_task.taskId.toString() ?? \"\"),\n \\_buildDetailsTableRow('Category', \\_task.categoryId ?? \"\"),\n \\_buildDetailsTableRow(\n 'Start Date', \\_task.taskStartDate.toString() ?? \"\"),\n \\_buildDetailsTableRow('Due Date', \\_task.dueDate.toString() ?? \"\"),\n \\_buildDetailsTableRow('Progress', \\_task.taskProgress.toString() ?? \"\"),\n \\_buildDetailsTableRow('Hour Estimate', \\_task.taskHour.toString() ?? \"\"),\n \\_buildDetailsTableRow('Client', \\_task.clientId ?? \"\"),\n \\_buildDetailsTableRow('Merchant', \\_task.merchantId ?? \"\"),\n \\_buildDetailsTableRow('Driver', \\_task.driverId ?? \"\"),\n ],\n );\n }\n\n TableRow \\_buildDetailsTableRow(String label, String value) {\n return TableRow(\n children: [\n Padding(\n padding: EdgeInsets.symmetric(vertical: 8.0),\n child: Text(\n label,\n style: TextStyle(fontWeight: FontWeight.bold),\n ),\n ),\n Padding(\n padding: EdgeInsets.symmetric(vertical: 8.0),\n child: Text(value),\n ),\n ],\n );\n }\n\n Widget \\_buildStatusButtons() {\n if (\\_task.taskStatus == 'Completed') {\n return SizedBox.shrink();\n }\n\n return Row(\n mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n children: [\n ElevatedButton(\n onPressed: \\_isLoading ? null : () => \\_updateStatus('In Progress'),\n child: Text('In Progress'),\n ),\n ElevatedButton(\n onPressed: \\_isLoading ? null : () => \\_updateStatus('Completed'),\n child: Text('Complete'),\n ),\n ],\n );\n }\n\n void \\_fetchComments() async {\n setState(() {\n \\_isLoading = true;\n });\n try {\n final comments =\n await ApiService().getTaskComments({}, \\_task.taskId.toString());\n\n setState(() {\n \\_comments = comments;\n });\n } catch (e) {\n // Handle error\n } finally {\n setState(() {\n \\_isLoading = false;\n });\n }\n }\n\n void \\_addComment(String comment) async {\n setState(() {\n \\_isLoading = true;\n });\n try {\n await ApiService().addTaskComment({}, \\_task.taskId.toString(), comment);\n\n setState(() {\n \\_comments.add(Comment(\n id: 1,\n comment: comment,\n createdBy: 'Me',\n createdDate: DateTime.now(),\n ));\n });\n } catch (e) {\n // Handle error\n } finally {\n setState(() {\n \\_isLoading = false;\n });\n }\n }\n\n void \\_updateStatus(String status) async {\n setState(() {\n \\_isLoading = true;\n });\n try {\n await ApiService().updateRMTask({}, \\_task.taskId.toString(), status, '');\n\n setState(() {\n \\_task.taskStatus = status;\n });\n } catch (e) {\n // Handle error\n } finally {\n setState(() {\n \\_isLoading = false;\n });\n }\n }\n}"
    },
    {
      "role": "assistant",
      "content": "Here's the modified Flutter code for Task Details page as per the requirements mentioned:\n```less\nimport 'package:efendim_admin/src/Tasks%20Managment/models/task.dart';\nimport 'package:efendim_admin/src/Tasks%20Managment/models/taskByCateg.dart';\nimport 'package:efendim_admin/src/Tasks%20Managment/services/api_service.dart';\nimport 'package:efendim_admin/src/Tasks%20Managment/widgets/custom_app_bar.dart';\nimport 'package:efendim_admin/src/Tasks%20Managment/widgets/task_comments.dart';\nimport 'package:flutter/material.dart';\nimport 'package:url_launcher/url_launcher.dart';\n\nimport '../models/activity.dart';\nimport '../models/comment.dart';\nimport '../widgets/task_activities.dart';\n\nclass TaskDetailsScreen extends StatefulWidget {\n  final TasksList task;\n\n  const TaskDetailsScreen({Key? key, required this.task}) : super(key: key);\n\n  @override\n  _TaskDetailsScreenState createState() => _TaskDetailsScreenState();\n}\n\nclass _TaskDetailsScreenState extends State<TaskDetailsScreen> {\n  late TasksList _task;\n  late List<Comment> _comments;\n  late bool _isLoading;\n\n  @override\n  void initState() {\n    super.initState();\n    _task = widget.task;\n    _comments = [];\n    _isLoading = false;\n    _fetchComments();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: CustomAppBar(\n        title: _task.taskName,\n        actions: [],\n      ),\n      body: SingleChildScrollView(\n        child: Container(\n          decoration: BoxDecoration(color: Colors.grey[200]),\n          child: Column(\n            crossAxisAlignment: CrossAxisAlignment.start,\n            children: [\n              // Section 1\n              Container(\n                decoration: BoxDecoration(\n                  color: Colors.white,\n                  borderRadius: BorderRadius.circular(8.0),\n                  boxShadow: [\n                    BoxShadow(\n                      color: Colors.grey.withOpacity(0.5),\n                      spreadRadius: 2,\n                      blurRadius: 5,\n                      offset: Offset(0, 3),\n                    ),\n                  ],\n                ),\n                margin: EdgeInsets.all(16.0),\n                padding: EdgeInsets.all(16.0),\n                child: Column(\n                  children: [\n                    Row(\n                      mainAxisAlignment: MainAxisAlignment.spaceBetween,\n                      children: [\n                        Text(\n                          _task.taskName,\n                          style: TextStyle(\n                            fontSize: 18.0,\n                            fontWeight: FontWeight.bold,\n                          ),\n                        ),\n                        Text(\n                          'Task ID: ${_task.taskId}',\n                          style: TextStyle(fontSize: 16.0),\n                        ),\n                      ],\n                    ),\n                    SizedBox(height: 16.0),\n                    Row(\n                      mainAxisAlignment: MainAxisAlignment.spaceBetween,\n                      children: [\n                        Text(\n                          'Related To: ${_task.relatedTo}',\n                          style: TextStyle(fontSize: 16.0),\n                        ),\n                        Text(\n                          'Task Status: ${_task.taskStatus}',\n                          style: TextStyle(fontSize: 16.0),\n                        ),\n                      ],\n                    ),\n                    SizedBox(height: 16.0),\n                    Row(\n                      mainAxisAlignment: MainAxisAlignment.spaceBetween,\n                      children: [\n                        Text(\n                          'Customer Group: ${_task.customerGroup}',\n                          style: TextStyle(fontSize: 16.0),\n                        ),\n                        Text(\n                          'Task Status: ${_task.taskStatus}',\n                          style: TextStyle(fontSize: 16.0),\n                        ),\n                      ],\n                    ),\n                    SizedBox(height: 16.0),\n                    Row(\n                      mainAxisAlignment: MainAxisAlignment.spaceBetween,\n                      children: [\n                        Text(\n                          'Created: ${_formatDate(_task.taskCreatedDate)}',\n                          style: TextStyle(fontSize: 16.0),\n                        ),\n                        Text(\n                          'Due: ${_formatDate(_task.dueDate)}',\n                          style: TextStyle\n```"
    }
  ]
}