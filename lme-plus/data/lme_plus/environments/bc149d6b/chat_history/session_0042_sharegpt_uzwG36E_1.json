{
  "session_id": "sharegpt_uzwG36E_1",
  "session_index": 42,
  "date": "2023/05/29 (Mon) 14:50",
  "turns": [
    {
      "role": "assistant",
      "content": "Sure, I can help you understand generating static params in Next.js 13.2 with examples using TypeScript. In Next.js, dynamic routes are used when the exact route path is not known ahead of time. With dynamic routes, you can generate routes based on data fetched from an external source, like a CMS or an API.\n\n`generateStaticParams` is a function that you can use in combination with dynamic route segments to define the list of route segment parameters that will be statically generated at build time. This allows you to pre-render pages based on dynamic data.\n\nLet's use a blog as an example. We will have a dynamic route with the following file structure:\n```bash\napp/blog/[slug]/page.tsx\n```\nWhere `[slug]` is the dynamic segment for blog post URLs.\n\nFirst, let's create the `page.tsx` file and define the page component:\n```typescript\n// app/blog/[slug]/page.tsx\n\nimport React from 'react';\n\ninterface PageProps {\n  params: {\n    slug: string;\n  };\n}\n\nconst Page: React.FC<PageProps> = ({ params }) => {\n  const { slug } = params;\n  return <div>Post with slug: {slug}</div>;\n};\n\nexport default Page;\n```\nNext, we'll define the `generateStaticParams` function, which will fetch the data and return an array of `params` objects with the slugs of the blog posts:\n```typescript\n// app/blog/[slug]/page.tsx\n\nimport type { GenerateStaticParams } from 'next';\n\ninterface Params {\n  slug: string;\n}\n\nexport const generateStaticParams: GenerateStaticParams<Params> = async () => {\n  const response = await fetch('https://.../posts');\n  const posts = await response.json();\n\n  return posts.map((post: { slug: string }) => ({\n    slug: post.slug,\n  }));\n};\n```\nWith this setup, during the build process, Next.js will call the `generateStaticParams` function, fetch the list of posts, and create a static version of the page for each post with the corresponding slug.\n\nWhen a user visits one of the blog post URLs, the corresponding static page will be served, making the page load faster.\n\nKeep in mind that the `generateStaticParams` function runs at build time, and the data fetching is automatically deduplicated. This means that if you have multiple instances of `generateStaticParams` with the same fetch request, the request will only be made once, reducing the build time.\n\nPlease let me know if you have any questions or need further clarification!"
    },
    {
      "role": "user",
      "content": "I want more detailed examples. How about using any free API to use to create more detailed example to understand its working practically?"
    },
    {
      "role": "assistant",
      "content": "Sure, let's use the JSONPlaceholder API to create a more detailed example. We'll create a simple blog app that fetches posts and users from the API.\n\n1. First, create a dynamic route for the blog posts:\n```bash\napp/blog/[postId]/page.tsx\n```\n1. Next, define the page component and the types for the post:\n```typescript\n// app/blog/[postId]/page.tsx\n\nimport React from 'react';\n\ninterface Post {\n  id: number;\n  title: string;\n  body: string;\n}\n\ninterface PageProps {\n  post: Post;\n}\n\nconst Page: React.FC<PageProps> = ({ post }) => {\n  return (\n    <div>\n      <h1>{post.title}</h1>\n      <p>{post.body}</p>\n    </div>\n  );\n};\n\nexport default Page;\n```\n1. Now, define the `generateStaticParams` function to fetch the post IDs:\n```typescript\n// app/blog/[postId]/page.tsx\n\nimport type { GenerateStaticParams } from 'next';\n\ninterface Params {\n  postId: string;\n}\n\nexport const generateStaticParams: GenerateStaticParams<Params> = async () => {\n  const response = await fetch('https://jsonplaceholder.typicode.com/posts');\n  const posts = await response.json();\n\n  return posts.map((post: { id: number }) => ({\n    postId: post.id.toString(),\n  }));\n};\n```\n1. Finally, define the `generateMetadata` function to fetch the individual post data:\n```typescript\n// app/blog/[postId]/page.tsx\n\nimport type { GenerateMetadata, Metadata } from 'next';\n\ninterface PostMetadata extends Metadata {\n  post: Post;\n}\n\nexport const generateMetadata: GenerateMetadata<Params, PostMetadata> = async (\n  { params }\n) => {\n  const response = await fetch(\n    `https://jsonplaceholder.typicode.com/posts/${params.postId}`\n  );\n  const post = await response.json();\n\n  return {\n    post,\n  };\n};\n\n// Update the Page component to receive metadata instead of params\nconst Page: React.FC<PostMetadata> = ({ post }) => {\n  // ...\n};\n```\nWith this setup, the `generateStaticParams` function will fetch the list of post IDs during the build process, and Next.js will generate a static page for each post. The `generateMetadata` function will fetch the post data, which will be passed to the page component as metadata.\n\nNow, let's create a simple page to list all the posts:\n\n1. Create a new file:\n```bash\napp/posts/page.tsx\n```\n1. Define the page component and types:\n```typescript\n// app/posts/page.tsx\n\nimport React from 'react';\nimport Link from 'next/link';\n\ninterface PostSummary {\n  id: number;\n  title: string;\n}\n\ninterface PageProps {\n  posts: PostSummary[];\n}\n\nconst Page: React.FC<PageProps> = ({ posts }) => {\n  return (\n    <div>\n      <h1>All Posts</h1>\n      <ul>\n        {posts.map((post) => (\n          <li key={post.id}>\n            <Link href={`/blog/${post.id}`}>\n              <a>{post.title}</a>\n            </Link>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default Page;\n```\n1. Define the `generateMetadata` function to fetch the list of posts:\n```typescript\n// app/posts/page.tsx\n\nimport type { GenerateMetadata, Metadata } from 'next';\n\ninterface PostListMetadata extends Metadata {\n  posts: PostSummary[];\n}\n\nexport const generateMetadata: GenerateMetadata<{}, PostListMetadata> = async () => {\n  const response = await\n```"
    },
    {
      "role": "user",
      "content": "continue"
    },
    {
      "role": "assistant",
      "content": "fetch('<https://jsonplaceholder.typicode.com/posts>');\nconst posts = await response.json();\n\nreturn {\nposts: posts.map((post: { id: number; title: string }) => ({\nid: post.id,\ntitle: post.title,\n})),\n};\n};\n\n// Update the Page component to receive metadata instead of params\nconst Page: React.FC<PostListMetadata> = ({ posts }) => {\n// ...\n};\n```vbnet\n\nWith this setup, the `generateMetadata` function for the `/posts` page fetches the list of all posts during the build process. The fetched posts are passed as metadata to the page component, which then renders the list of posts with links to their respective pages.\n\nNow you have a simple blog app that uses the JSONPlaceholder API to fetch data and statically generates pages for all the blog posts. This example demonstrates how to use `generateStaticParams` and `generateMetadata` functions in Next.js 13 with TypeScript to fetch and display data from an external API.\n```"
    }
  ]
}