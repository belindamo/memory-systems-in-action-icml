{
  "turn_global_index": 34,
  "session_index": 3,
  "session_id": "sharegpt_hF1ycSS_54",
  "turn_in_session": 0,
  "date": "2023/05/20 (Sat) 06:49",
  "role": "user",
  "content": "import csv\nimport re\nimport sys\n\ndef parse\\_csv(input\\_file, output\\_file, parse\\_rules):\n \"\"\"\n Extracts data from a CSV file according to the specified parse rules and writes the extracted data to a new CSV file.\n\n Parameters:\n input\\_file (str): The path to the input CSV file.\n output\\_file (str): The path to the output CSV file.\n parse\\_rules (list): A list of dictionaries specifying the parse rules to apply to each row of the input file. Each dictionary should have two keys: 'column\\_index', which specifies the index of the column to extract data from, and 'regex', which specifies the regular expression to use to extract the data.\n\n Returns:\n None\n \"\"\"\n # Open the output file and create a CSV writer object\n try:\n with open(output\\_file, 'w') as f:\n writer = csv.writer(f)\n except Exception as e:\n # Print an error message and exit the program if the output file can't be opened or written to\n print(f'Error opening or writing to output file: {e}')\n sys.exit(1)\n\n # Open the input file and create a CSV reader object\ntry:\n with open(input\\_file, 'r') as f:\n reader = csv.reader(f)\nexcept Exception as e:\n # Print an error message and exit the program if the input file doesn't exist or can't be read\n print(f'Error reading input file: {e}')\n sys.exit(1)\n\n# Iterate through the rows in the input file\nfor row in reader:\n # Extract the desired data according to the parse rules\n try:\n extracted\\_data = apply\\_parse\\_rules(row, parse\\_rules)\n except Exception as e:\n # Print an error message and continue to the next row if an error occurs while applying the parse rules\n print(f'Error applying parse rules: {e}')\n continue\n\n # Write the extracted data to the output file\n writer.writerow(extracted\\_data)\ndef apply\\_parse\\_rule(row, rule):\n # Extract the desired data from the specified column\n column\\_data = row[rule['column\\_index']]\n \n # Use the regular expression specified in the parse rule to extract the desired data\n extracted\\_data = re.search(rule['regex'], column\\_data).group()\n \n return extracted\\_data\n\nif \\_\\_name\\_\\_ == '\\_\\_main\\_\\_':\n # Define the input file and output file\n input\\_file = 'input.csv'\n output\\_file = 'output.csv'\n\n # Define the parse rules list\n parse\\_rules\\_list = [\n [{'column\\_index': 0, 'regex': r'\\d+'}, {'column\\_index': 1, 'regex': r'[A-Za-z]+'}],\n [{'column\\_index': 0, 'regex': r'\\d{4}-\\d{2}-\\d{2}'}, {'column\\_index': 1, 'regex': r'\\d+'}],\n ]\n\n # Call the parse\\_csv function to extract data from the input file and write it to the output file",
  "has_answer": false
}