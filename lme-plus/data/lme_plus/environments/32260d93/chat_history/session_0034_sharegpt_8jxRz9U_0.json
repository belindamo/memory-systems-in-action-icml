{
  "session_id": "sharegpt_8jxRz9U_0",
  "session_index": 34,
  "date": "2023/05/28 (Sun) 13:53",
  "turns": [
    {
      "role": "user",
      "content": "write a wordpress function that allows me use a shortcode to display a list of custom posts. The short code should allow me to specify how many posts, a category, and a taxonomy"
    },
    {
      "role": "assistant",
      "content": "Here is an example function that you can use to create a shortcode for displaying a list of custom posts:\n```php\nfunction custom_post_list_shortcode( $atts ) {\n    $atts = shortcode_atts( array(\n        'number_of_posts' => 5,\n        'category' => '',\n        'taxonomy' => '',\n    ), $atts, 'custom_post_list' );\n \n    $args = array(\n        'post_type' => 'custom_post',\n        'posts_per_page' => $atts['number_of_posts'],\n    );\n \n    if ( ! empty( $atts['category'] ) ) {\n        $args['category_name'] = $atts['category'];\n    }\n \n    if ( ! empty( $atts['taxonomy'] ) ) {\n        $args['tax_query'] = array(\n            array(\n                'taxonomy' => $atts['taxonomy'],\n                'field'    => 'slug',\n                'terms'    => $atts['taxonomy'],\n            ),\n        );\n    }\n \n    $query = new WP_Query( $args );\n \n    if ( $query->have_posts() ) {\n        $output = '<ul>';\n        while ( $query->have_posts() ) {\n            $query->the_post();\n            $output .= '<li><a href=\"' . get_the_permalink() . '\">' . get_the_title() . '</a></li>';\n        }\n        wp_reset_postdata();\n        $output .= '</ul>';\n    } else {\n        $output = 'No custom posts found.';\n    }\n \n    return $output;\n}\nadd_shortcode( 'custom_post_list', 'custom_post_list_shortcode' );\n```\nYou can use the shortcode [custom\\_post\\_list number\\_of\\_posts=\"5\" category=\"category-slug\" taxonomy=\"taxonomy-slug\"] to display the list of custom post.\nYou can use it in any post or page and you can change number\\_of\\_posts, category and taxonomy as per your requirement."
    },
    {
      "role": "user",
      "content": "update the code to instead of showing posts, display custom post type named \"policy\""
    },
    {
      "role": "assistant",
      "content": "Here is the updated function that will display a list of custom post type \"policy\" instead of posts:\n```php\nfunction custom_post_list_shortcode( $atts ) {\n    $atts = shortcode_atts( array(\n        'number_of_posts' => 5,\n        'category' => '',\n        'taxonomy' => '',\n    ), $atts, 'custom_post_list' );\n \n    $args = array(\n        'post_type' => 'policy',\n        'posts_per_page' => $atts['number_of_posts'],\n    );\n \n    if ( ! empty( $atts['category'] ) ) {\n        $args['category_name'] = $atts['category'];\n    }\n \n    if ( ! empty( $atts['taxonomy'] ) ) {\n        $args['tax_query'] = array(\n            array(\n                'taxonomy' => $atts['taxonomy'],\n                'field'    => 'slug',\n                'terms'    => $atts['taxonomy'],\n            ),\n        );\n    }\n \n    $query = new WP_Query( $args );\n \n    if ( $query->have_posts() ) {\n        $output = '<ul>';\n        while ( $query->have_posts() ) {\n            $query->the_post();\n            $output .= '<li><a href=\"' . get_the_permalink() . '\">' . get_the_title() . '</a></li>';\n        }\n        wp_reset_postdata();\n        $output .= '</ul>';\n    } else {\n        $output = 'No policy post found.';\n    }\n \n    return $output;\n}\nadd_shortcode( 'custom_post_list', 'custom_post_list_shortcode' );\n```\nThis will now display the list of custom post type \"policy\" and you can use the shortcode [custom\\_post\\_list number\\_of\\_posts=\"5\" category=\"category-slug\" taxonomy=\"taxonomy-slug\"] to display the list of policies."
    },
    {
      "role": "user",
      "content": "update the code to use a taxonomy's category instead of WordPress post category. For the Policy custom post type, I have a taxonomy called Topic, and I need the shortcode to list the Policies within the given Topic such as \"academic-affairs\" or \"student-life\""
    },
    {
      "role": "assistant",
      "content": "Here is the updated function that will use a taxonomy's category instead of WordPress post category:\n```php\nfunction custom_post_list_shortcode( $atts ) {\n    $atts = shortcode_atts( array(\n        'number_of_posts' => 5,\n        'topic' => '',\n    ), $atts, 'custom_post_list' );\n \n    $args = array(\n        'post_type' => 'policy',\n        'posts_per_page' => $atts['number_of_posts'],\n    );\n \n    if ( ! empty( $atts['topic'] ) ) {\n        $args['tax_query'] = array(\n            array(\n                'taxonomy' => 'topic',\n                'field'    => 'slug',\n                'terms'    => $atts['topic'],\n            ),\n        );\n    }\n \n    $query = new WP_Query( $args );\n \n    if ( $query->have_posts() ) {\n        $output = '<ul>';\n        while ( $query->have_posts() ) {\n            $query->the_post();\n            $output .= '<li><a href=\"' . get_the_permalink() . '\">' . get_the_title() . '</a></li>';\n        }\n        wp_reset_postdata();\n        $output .= '</ul>';\n    } else {\n        $output = 'No policies found for the given topic.';\n    }\n \n    return $output;\n}\nadd_shortcode( 'custom_post_list', 'custom_post_list_shortcode' );\n```\nNow you can use the shortcode [custom\\_post\\_list number\\_of\\_posts=\"5\" topic=\"academic-affairs\"] to display the list of policies within the topic \"academic-affairs\" or [custom\\_post\\_list number\\_of\\_posts=\"5\" topic=\"student-life\"] to display the list of policies within the topic \"student-life\"\n\nYou should make sure that the taxonomy \"topic\" has been registered for the custom post type \"policy\" before using this shortcode."
    },
    {
      "role": "user",
      "content": "code a wordpress shortcode that could display the first 5 policies of each topic. The topic should be displayed as an  and the custom post type policies should be a hyperlinked list\n---------------------------------------------------------------"
    },
    {
      "role": "assistant",
      "content": "Here is the updated function that will display the first 5 policies of each topic:\n```php\nfunction custom_post_list_shortcode() {\n    $terms = get_terms( array(\n        'taxonomy' => 'topic',\n        'hide_empty' => false,\n    ) );\n    $output = '';\n    foreach ( $terms as $term ) {\n        $output .= '<h2>' . $term->name . '</h2>';\n        $args = array(\n            'post_type' => 'policy',\n            'posts_per_page' => 5,\n            'tax_query' => array(\n                array(\n                    'taxonomy' => 'topic',\n                    'field' => 'slug',\n                    'terms' => $term->slug,\n                ),\n            ),\n        );\n        $query = new WP_Query( $args );\n        if ( $query->have_posts() ) {\n            $output .= '<ul>';\n            while ( $query->have_posts() ) {\n                $query->the_post();\n                $output .= '<li><a href=\"' . get_the_permalink() . '\">' . get_the_title() . '</a></li>';\n            }\n            wp_reset_postdata();\n            $output .= '</ul>';\n        } else {\n            $output .= 'No policies found for this topic.';\n        }\n    }\n    return $output;\n}\nadd_shortcode( 'custom_post_list', 'custom_post_list_shortcode' );\n```\nThis shortcode will display all the terms in the taxonomy \"topic\" as an <h2> and then it will list the first 5 policies of each topic as a hyperlinked list.\nYou can use the shortcode [custom\\_post\\_list] in any post or page to display the list of policies.\nMake sure that the taxonomy \"topic\" has been registered for the custom post type \"policy\" before using this shortcode."
    },
    {
      "role": "user",
      "content": "Create a wordpress php single template for a custom post type called Policy. The post should display associated Advanced Custom Fields for Title, Published Date, Unit (a custom taxonomy), Topic (a custom taxonomy), Body content, Additional Resources (a collapsible row), History (a collapsible row)"
    },
    {
      "role": "assistant",
      "content": "Here is an example of a single template for the custom post type \"Policy\":\n```php\n<?php \n/*\nTemplate Name: Policy Single\n*/\nget_header(); ?>\n\n<div id=\"primary\" class=\"content-area\">\n    <main id=\"main\" class=\"site-main\" role=\"main\">\n        <?php while ( have_posts() ) : the_post(); ?>\n            <article id=\"post-<?php the_ID(); ?>\" <?php post_class(); ?>>\n                <header class=\"entry-header\">\n                    <h1 class=\"entry-title\"><?php the_title(); ?></h1>\n                    <div class=\"entry-meta\">\n                        <?php echo 'Published on: ' . get_field('published_date'); ?>\n                    </div><!-- .entry-meta -->\n                </header><!-- .entry-header -->\n\n                <div class=\"entry-content\">\n                    <div class=\"taxonomies\">\n                        <?php \n                            $unit_terms = get_the_terms( get_the_ID(), 'unit' );\n                            if ( !empty($unit_terms) ) {\n                                echo '<p>Unit: ';\n                                foreach ( $unit_terms as $term ) {\n                                    echo $term->name . ' ';\n                                }\n                                echo '</p>';\n                            }\n                        ?>\n                        <?php \n                            $topic_terms = get_the_terms( get_the_ID(), 'topic' );\n                            if ( !empty($topic_terms) ) {\n                                echo '<p>Topic: ';\n                                foreach ( $topic_terms as $term ) {\n                                    echo $term->name . ' ';\n                                }\n                                echo '</p>';\n                            }\n                        ?>\n                    </div>\n                    <?php the_content(); ?>\n                    <?php \n                        $additional_resources = get_field('additional_resources');\n                        if ( !empty($additional_resources) ) {\n                            echo '<h3>Additional Resources</h3>';\n                            echo '<div class=\"collapsible-content\">' . $additional_resources . '</div>';\n                        }\n                    ?>\n                    <?php \n                        $history = get_field('history');\n                        if ( !empty($history) ) {\n                            echo '<h3>History</h3>';\n                            echo '<div class=\"collapsible-content\">' . $history . '</div>';\n                        }\n                    ?>\n                </div><!-- .entry-content -->\n\n                <footer class=\"entry-footer\">\n                    <?php edit_post_link( 'Edit', '<span class=\"edit-link\">', '</span>' ); ?>\n                </footer><!-- .entry-footer -->\n            </article><!-- #post-## -->\n        <?php endwhile; // end of the loop. ?>\n    </main><!-- #main -->\n</div><!-- #primary -->\n\n<?php get_sidebar(); ?>\n<?php get_footer(); ?>\n```\nThis template will display the title, published date,"
    }
  ]
}