{
  "turn_global_index": 311,
  "session_index": 32,
  "session_id": "sharegpt_oAmhHcP_0",
  "turn_in_session": 3,
  "date": "2023/10/01 (Sun) 18:01",
  "role": "assistant",
  "content": "Sure, here's an example of an event sourcing application using the `eventstoredb` library in Python:\n```\nimport json\nfrom eventstoredb.client import EventStoreClient\n\nclass Account:\n    def __init__(self, client, stream_name):\n        self.client = client\n        self.stream_name = stream_name\n        self.balance = 0\n\n    def deposit(self, amount):\n        self.balance += amount\n        event = {'type': 'deposit', 'amount': amount}\n        self.client.append_to_stream(self.stream_name, json.dumps(event))\n\n    def withdraw(self, amount):\n        self.balance -= amount\n        event = {'type': 'withdraw', 'amount': amount}\n        self.client.append_to_stream(self.stream_name, json.dumps(event))\n\n    def get_balance(self):\n        return self.balance\n\n    def replay(self):\n        for event in self.client.get_all_events(self.stream_name):\n            event_data = json.loads(event.data)\n            if event_data['type'] == 'deposit':\n                self.balance += event_data['amount']\n            elif event_data['type'] == 'withdraw':\n                self.balance -= event_data['amount']\n\nclient = EventStoreClient()\naccount = Account(client, 'my-account')\naccount.deposit(100)\naccount.withdraw(50)\nprint(account.get_balance()) # 50\naccount.replay() # replay events\nprint(account.get_balance()) # 50\n```\nThis example uses the `eventstoredb` library to interact with an Event Store server. It creates an `Account` class that has methods for making deposits and withdrawals, as well as getting the current balance. The events are appended to the stream in the Event Store server every time a deposit or withdrawal is made. The `replay` method is added to replay events from the event store, this method iterates over all events in the stream and apply the appropriate changes to the account balance.\n\nYou can connect to your running eventstore server by providing the connection details such as host, port and credentials to the `EventStoreClient` constructor.\n\nPlease note that the above example is just a demonstration of the basic concepts of event sourcing with eventstore, and it should be adjusted and fine-tuned for production use.",
  "has_answer": false
}