{
  "turn_global_index": 384,
  "session_index": 38,
  "session_id": "sharegpt_GKjb2be_0",
  "turn_in_session": 5,
  "date": "2023/05/29 (Mon) 02:20",
  "role": "assistant",
  "content": "Unfortunately, adding a custom video option to the drop-down menu in the Screen Saver settings is not possible using PowerShell alone. This requires modifying the Windows registry and creating a custom .scr screensaver file.\n\nHere are the high-level steps you can follow to create a custom screensaver option for your MP4 video file:\n\n1. Create a new folder to store the custom screensaver file and the video file. For example, you can create a folder named `MyScreensavers` in the `C:\\Windows\\System32` folder.\n2. Copy your MP4 video file to the `MyScreensavers` folder.\n3. Open Notepad or your preferred text editor.\n4. Copy and paste the following code into the text editor:\n```csharp\nusing System;\nusing System.Windows.Forms;\n\npublic class VideoScreensaver : Form\n{\n    private AxWMPLib.AxWindowsMediaPlayer axWindowsMediaPlayer;\n\n    public VideoScreensaver(string videoFilePath)\n    {\n        this.StartPosition = FormStartPosition.Manual;\n        this.Bounds = Screen.PrimaryScreen.Bounds;\n\n        this.axWindowsMediaPlayer = new AxWMPLib.AxWindowsMediaPlayer();\n        this.axWindowsMediaPlayer.Dock = DockStyle.Fill;\n        this.axWindowsMediaPlayer.uiMode = \"none\";\n        this.axWindowsMediaPlayer.URL = videoFilePath;\n        this.Controls.Add(this.axWindowsMediaPlayer);\n    }\n\n    [STAThread]\n    public static void Main(string[] args)\n    {\n        Application.EnableVisualStyles();\n        Application.SetCompatibleTextRenderingDefault(false);\n\n        if (args.Length == 1)\n        {\n            string videoFilePath = args[0];\n            Application.Run(new VideoScreensaver(videoFilePath));\n        }\n        else\n        {\n            MessageBox.Show(\"Invalid command-line arguments.\", \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n        }\n    }\n}\n```\n5. Save the file with a `.cs` extension (e.g., `VideoScreensaver.cs`) in a convenient location (e.g., `C:\\Screensavers`).\n6. Open the Visual Studio Developer Command Prompt as an administrator.\n7. Type `cd C:\\Screensavers` (or the location where you saved the file) and press Enter.\n8. Type the following command to compile the code into an executable file:\n```bash\ncsc /target:winexe /out:C:\\Windows\\System32\\MyScreensavers\\MyVideoScreensaver.scr /platform:x64 /reference:\"C:\\Program Files (x86)\\Windows Kits\\10\\References\\10.0.19041.0\\Windows.Foundation.FoundationContract\\3.0.0.0\\Windows.Foundation.FoundationContract.winmd\" /reference:\"C:\\Program Files (x86)\\Windows Kits\\10\\References\\10.0.19041.0\\Windows.Foundation.UniversalApiContract\\10.0.19041.0\\Windows.Foundation.UniversalApiContract.winmd\" VideoScreensaver.cs /win32icon:C:\\Windows\\System32\\MyScreensavers\\MyIcon.ico\n```\nThis command will create a new `.scr` file named `MyVideoScreensaver.scr` in the `C:\\Windows\\System32\\MyScreensavers` folder. It will also reference the necessary Windows SDK libraries to compile the code.\nNote: You need to replace `C:\\Program Files (x86)\\Windows Kits\\10\\References\\10.0.19041.0` with the path to the appropriate Windows SDK version on your system.\n\n9. Create a new registry key to add the custom screensaver option to the Screen Saver settings:\n```sql\nNew-Item -Path \"HKCU:\\Control Panel\\Screen Saver.VideoScreensaver\" -Force\nNew-ItemProperty -Path \"HKCU:\\Control Panel\\Screen Saver.VideoScreensaver\" -Name \"DisplayName\" -\n```",
  "has_answer": false
}