{
  "turn_global_index": 16,
  "session_index": 2,
  "session_id": "sharegpt_l7gyE1o_17",
  "turn_in_session": 2,
  "date": "2023/05/20 (Sat) 05:03",
  "role": "assistant",
  "content": "Here's a more specific script that spins up an Amazon Linux 2 instance and allows SSH (port 22) access from the public IP of the machine running the script. Note that this script assumes you have `jq` and `curl` installed on your system.\n```bash\n#!/bin/bash\n\n# Set variables\nINSTANCE_TYPE=\"t2.micro\"\nKEY_PAIR_NAME=\"your-key-pair-name\"\nSECURITY_GROUP_NAME=\"ProxmoxSSHAccess\"\n\n# Get the latest Amazon Linux 2 AMI ID\nAMI_ID=$(aws ec2 describe-images --owners amazon --filters 'Name=name,Values=amzn2-ami-hvm-2.0.????????-x86_64-gp2' 'Name=state,Values=available' --query 'reverse(sort_by(Images, &CreationDate))[:1].ImageId' --output text)\n\n# Get the public IP of the machine running the script\nMY_PUBLIC_IP=$(curl -s https://ipinfo.io/ip)\n\n# Create a security group\naws ec2 create-security-group --group-name $SECURITY_GROUP_NAME --description \"Allow SSH access from current public IP\"\n\n# Get the security group ID\nSECURITY_GROUP_ID=$(aws ec2 describe-security-groups --group-names $SECURITY_GROUP_NAME --query 'SecurityGroups[0].GroupId' --output text)\n\n# Add a rule to allow SSH (port 22) access from the current public IP\naws ec2 authorize-security-group-ingress --group-id $SECURITY_GROUP_ID --protocol tcp --port 22 --cidr ${MY_PUBLIC_IP}/32\n\n# Launch the EC2 instance\naws ec2 run-instances \\\n  --image-id $AMI_ID \\\n  --instance-type $INSTANCE_TYPE \\\n  --security-group-ids $SECURITY_GROUP_ID \\\n  --key-name $KEY_PAIR_NAME \\\n  --count 1 \\\n  --output json\n```\nBefore running the script, replace `your-key-pair-name` with the name of your existing EC2 key pair, which is used to access the instance via SSH.\n\nThis script does the following:\n\n1. Retrieves the latest Amazon Linux 2 AMI ID.\n2. Gets the public IP of the machine running the script.\n3. Creates a new security group named \"ProxmoxSSHAccess.\"\n4. Adds a rule to the security group to allow SSH (port 22) access from the public IP of the machine running the script.\n5. Launches an EC2 instance using the Amazon Linux 2 AMI, the specified instance type, and the security group.\n\nAfter running the script and waiting for the instance to become available, you can SSH into the instance using the private key associated with the specified key pair.\n\nKeep in mind that opening SSH access directly to the public internet may not be the most secure approach. You might consider using a bastion host or VPN to further secure access to your instances.",
  "has_answer": false
}