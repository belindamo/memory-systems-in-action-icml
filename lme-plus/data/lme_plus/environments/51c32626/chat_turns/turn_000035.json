{
  "turn_global_index": 35,
  "session_index": 3,
  "session_id": "sharegpt_qLhP2Ty_0",
  "turn_in_session": 5,
  "date": "2023/05/20 (Sat) 12:13",
  "role": "assistant",
  "content": "To create a recurring subscription that renews on the 15th day of every new quarter, you need to set the following options:\n\n1. In the payment definition, set the `frequency` to `Month` and the `frequency_interval` to `3`:\n```css\npayment_definitions: [\n    {\n      name: 'Quarterly Subscription',\n      type: 'REGULAR',\n      frequency: 'Month',\n      frequency_interval: '3',\n      amount: {\n        value: '24.99',\n        currency: 'USD'\n      },\n      cycles: '0'\n    }\n]\n```\n2. In the billing agreement, set the `start_date` to the 15th day of the current quarter:\n```vbnet\nstart_date: new Date(Date.now() + (15 - new Date().getDate()) * 24 * 60 * 60 * 1000).toISOString()\n```\nThis code calculates the number of milliseconds until the next 15th day, and sets the start date to that day.\n\nHere's the complete code example:\n```css\n// Step 1: Create a plan\nvar plan = {\n  name: 'Quarterly Subscription',\n  description: 'Quarterly recurring subscription for access to premium content.',\n  type: 'INFINITE',\n  payment_definitions: [\n    {\n      name: 'Quarterly Subscription',\n      type: 'REGULAR',\n      frequency: 'Month',\n      frequency_interval: '3',\n      amount: {\n        value: '24.99',\n        currency: 'USD'\n      },\n      cycles: '0'\n    }\n  ],\n  merchant_preferences: {\n    auto_bill_amount: 'YES',\n    cancel_url: 'https://example.com/cancel',\n    return_url: 'https://example.com/return',\n    notify_url: 'https://example.com/notify'\n  }\n};\n\n// Step 2: Create an agreement\nvar agreement = {\n  name: 'Quarterly Subscription',\n  description: 'Quarterly recurring subscription for access to premium content.',\n  start_date: new Date(Date.now() + (15 - new Date().getDate()) * 24 * 60 * 60 * 1000).toISOString(),\n  plan: {\n    id: plan.id\n  },\n  payer: {\n    payment_method: 'paypal'\n  }\n};\n\npaypal.billingAgreement.create(agreement, function (error, agreement) {\n  if (error) {\n    console.error(error);\n    return;\n  }\n\n  // Step 3: Redirect the payer\n  window.location.href = agreement.links[1].href;\n});\n```",
  "has_answer": false
}